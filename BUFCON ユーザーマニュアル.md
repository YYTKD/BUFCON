# BUFCON ユーザーマニュアル
---
## 概要

**BUFCON**はTRPGのオンラインセッションでの戦闘をサポートするWebツールです。
キャラクターのバフ/デバフの管理、それらを反映した判定やダメージ計算用のコマンド生成ができます。
ブラウザソフトさえあればオフラインで利用できるため、どこでも使用できます。

対応システム：ココフォリア、ユドナリウムなどのBCDiceに対応したオンラインセッションツール。

---

## 機能紹介

### ステータス登録
オンラインセッションツールで使用しているキャラクターの能力値（変数名）を登録し、判定・攻撃時に反映させます。

### バフ/デバフ管理
一時的なボーナス・ペナルティ（以降、それらをまとめてバフと呼ぶ）を設定し、オン/オフや残りターン数の管理ができます。

### 判定支援
各種判定パッケージを登録し、バフを反映させたたものをBCDiceで使用できるコマンドにして生成します。

### 攻撃支援
攻撃パターンを登録し、バフを反映させたたものをBCDiceで使用できるコマンドにして生成します。
### データ管理
設定をJSONで保存・読み込みできます。


---


# 基本的な使い方

## ステータスの追加

1. **「ステータス」セクション**を開く
2. 入力欄にステータス名を入力（例：筋力、魔力、DEX）
3. 複数追加する場合はカンマで区切る（例：`筋力,魔力,DEX`）
4. 「+」ボタンをクリック
5. 追加したステータスがタグ形式で表示される

---
---

## バフの追加

<mark>※バフを反映させる先の判定や攻撃が存在していてないと指定ができないので、実用の際はそれらを先に登録することを推奨します</mark>

1. **「バフ/デバフ」セクション**を開く
2. 各項目を入力：
   - **バフ名**：効果の名称（例：ファイアウェポン）
   - **効果先**：適用対象を選択（判定名または攻撃名）
   - **説明**：補足説明（例：命中UP、与魔法ダメージ⬇）
   - **効果**：BCDiceコマンド（例：+2、+1d6、-1）
   - **ターン**：継続ターン数（整数値）
   - **カラー**：表示色（サンプルまたはカラーピッカーで選択）

3. 「+」ボタンをクリック

### 一括追加

「一括追加」では以下の記法を用いて複数のバフを一度に登録できます。


形式：`バフ名|効果先1,効果先2|説明|効果|ターン|カラーコード`
```
例：
ファイアウェポン|すべての攻撃|ダメージUP|+2|3|#DF383E
ハイテンション|命中,武器A|命中・ダメ⬆|+1d6|5
```
- 効果先はカンマ区切りで複数指定可能
- 説明・効果・ターン・カラーコードは省略可


### バフの効果先について

**「効果先」で選択できる対象**
- **なし**：何にも適用しない
- **すべての判定**：登録した全判定に適用
- **すべての攻撃**：登録した全攻撃に適用
- **個別の判定名**：特定の判定のみに適用
- **個別の攻撃名**：特定の攻撃のみに適用

### バフの管理

**ON/OFF：** 右側のトグルボタンで有効・無効を切り替え

**ターン経過：** 「ターン経過」ボタンをクリックするとすべてのバフのターン数が1減少。0になると自動的にOFFになります。

**ドラッグ操作：** バフを上下にドラッグして順序を変更できます。有効なバフが上から順に判定・攻撃コマンドに反映されます。

---

## 判定の追加と使用

### 判定の追加

1. 各項目を入力：
   - **判定名**：判定の種類（例：命中判定）
   - **判定ロール**：基本となるダイスロール（例：1d20、2d6+1）
   - **ステータス**：関連するステータス（例：器用B、DEX）

2. 「+」ボタンをクリック

#### 一括追加方法

1. 「一括追加」をクリック
2. 以下の記法で記入する
3.  複数追加する場合はカンマで区切る
   形式：`判定名|判定ロール|ステータス名,ステータス名`

```
例：
命中判定|2d6+1|器用B
回避判定|1d20|DEX
```

3. 「追加を実行」をクリック

### コマンド生成

1. 一覧から目的の判定をクリック（選択状態になる）
2. 下部の「コピペ用コマンド」欄にコマンドが生成される
3. 「コピー」ボタンでコマンドをコピー
4. セッションツールのチャットに貼り付けて実行

**生成されるコマンドの構成：**
```
判定ロール+{ステータス}+アクティブなバフの効果>=目標値
```

#### 目標値の設定

コマンドに目標値を設定する：

- **目標値なし**：「なし」を選択
- **上方判定**：「>=」を選択して数値入力
- **下方判定**：「=<」を選択して数値入力

`目標値を入力していない場合、>=/=<はコマンドに入力されません`

---

## 攻撃の追加と使用

判定と同様の方法で攻撃を管理します。

### 攻撃の追加

1. 各項目を入力：
   - **攻撃名**：攻撃の種類（例：クレイモア）
   - **攻撃ロール**：基本となるダイスロール（例：2d6、K20@10）
   - **ステータス**：関連するステータス（例：筋力B,STR）

2. 「+」ボタンをクリック

### 一括追加方法

1. 「一括追加」をクリック
2. 以下の記法で記入する
3.  複数追加する場合はカンマで区切る
   形式：`攻撃名|攻撃ロール|ステータス名,ステータス名`

```
例：
クレイモア|2d6|STR
ファイアボール|K20@10|魔力
```

#### コマンド生成

1. 一覧から目的の攻撃をクリック
2. 下部の「コピペ用コマンド」欄にコマンドが生成される
3. 「コピー」ボタンでコマンドをコピー
4. セッションツールのチャットに貼り付けて実行

**生成されるコマンドの構成**
```
攻撃ロール+{ステータス}+アクティブなバフの効果 攻撃名
```
---
## データの管理

### エクスポート（保存）

1. 「データ管理」セクションを開く
2. 「設定をクリップボードにコピー」をクリック
3. JSONがコピーされる
4. メモ帳などに貼り付けて保存

### インポート（読み込み）

1. 「データ管理」セクションを開く
2. 下部のテキストエリアに保存されたJSON(クリップビードにコピーした文字列)を貼り付ける
3. 「読み込み実行」をクリック
4. すべての設定が復元される

:::note info
(v1.2.0)
データの文字列が保存された.txtファイルや.jsonファイルをドラッグアンドドロップして読み込めるようになりました。
:::

### リセット

1. 「データ管理」セクション下部の「すべて初期化」をクリック
2. 確認ダイアログで「OK」を選択
3. すべての設定がリセットされます（リセットの取り消し不可）

---
---

## トラブルシューティング

### コマンドが反映されない

- ✅ 判定/攻撃がリストで選択されているか確認
- ✅ ステータス名がキャラクターシートに設定されているか確認
- ✅ バフが無効（半透明）になっていないか確認

### バフが消えない

- ✅ 手動で削除する場合は「×」ボタンをクリック
- ✅ 「ターンを経過」でターン数を減らしてください
- ✅ ターン数が設定されていない可能性があります

### データが保存されない

- ✅ ブラウザのローカルストレージが満杯の可能性があります
- ✅ キャッシュをクリアして再度試してください
- ✅ 定期的にエクスポートでバックアップを取ることを推奨します

### カラー設定が反映されない

- ✅ カラーコード形式は`#RRGGBB`形式です（例：#FF0000）
- ✅ 6文字の16進数コードであることを確認してください


---

## データ形式リファレンス

### エクスポートされるJSON形式

```json
{
  "stats": [
    { "name": "ステータス名" }
  ],
  "buffs": [
    {
      "name": "バフ名",
      "description": "説明",
      "effect": "効果",
      "targets": ["効果先"],
      "turn": 現在効果ターン(数字),
      "originalTurn": 最大効果ターン(数字),
      "color": "#16進数カラーコード",
      "active": true
    }
  ],
  "judges": [
    {
      "name": "判定名",
      "roll": "判定ロール",
      "stat": "ステータス名+ステータス名"
    }
  ],
  "attacks": [
    {
      "name": "攻撃名",
      "roll": "攻撃ロール",
      "stat": "ステータス名+ステータス名"
    }
  ]
}
```

---

## よくある質問

**Q: ステータスを数値で管理できますか？**
A: BUFCONは変数のラベルとしてのステータス名のみを管理します。数値はセッションツールのキャラクターに紐づけられた変数を利用します。

**Q: 複数の判定に同じバフを適用したい場合は？**
A: 効果先で「すべての判定」を選択するか、対象の判定名をカンマ区切りで指定してください。

**Q: バフの順序は重要ですか？**
A: はい。コマンドが末尾に来ることが必要な場合は、該当のバフを一番下にドラッグしてください。
。BCDiceではコマンドを左から順に評価します。

**Q: オフラインで使用できますか？**
A: はい。ローカルアプリのため、ソースファイルをダウンロードした場合はオフラインでも使用できます。

**Q: 追加したバフや判定の設定を変更できますか？**
A: いいえ。今のところ`(2025/12/19)`、一度追加したアイテムに行える変更はターン進行とON/OFFの切り替え、削除のみです。追加後の編集機能は後日実装予定です。

---

<details>
<summary>## 更新履歴</summary>

- **v1.0.0**：初版リリース
  - ステータス管理機能
  - バフ/デバフ管理機能
  - 判定・攻撃コマンド生成機能
  - データ管理機能（エクスポート・インポート）

- **v1.1.0**
  - UI改善
  - マニュアル追加
  - フィードバックフォーム追加
  - 判定/攻撃への複数ステータス選択を追加

- **v1.2.0**
  - レスポンシブデザインに対応
  - 追加フォームをポップアップダイアログに変更
  - ファイルを直接インポートする機能を追加

</details>